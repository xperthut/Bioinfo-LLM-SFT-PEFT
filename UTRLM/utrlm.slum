#!/bin/bash

#SBATCH --job-name=GROVER
#SBATCH --nodes=1
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=8
#SBATCH --time=1-12:00:00 
#SBATCH --partition=ampere 
#SBATCH --output=slurm_%j.out 
#SBATCH --error=slurm_%j.err

# Load your conda environment
CONDA_BASE_DIR=~/software/miniconda3
source "$CONDA_BASE_DIR/etc/profile.d/conda.sh"
source activate torch_cuda_128

export CUDA_LAUNCH_BLOCKING=1
export TORCH_USE_CUDA_DSA=1

python3 utrlm.py \
--dbname $1 \
--batch-size=64 \
--max-length=512